<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="HandheldFriendly" content="true">
    <title>ECHO Technology Store - Tu Tienda Virtual</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        /* --- VARIABLES CSS (Tema Claro/Oscuro) --- */
        :root {
            --primary: #4361ee;
            --primary-dark: #3a0ca3;
            --primary-light: #4895ef;
            --secondary: #f72585;
            --secondary-dark: #b5179e;
            --accent: #4cc9f0;
            --success: #4ade80;
            --warning: #f59e0b;
            --error: #ef4444;
            --dark: #1e293b;
            --darker: #0f172a;
            --light: #f8fafc;
            --gray: #64748b;
            --gray-light: #cbd5e1;
            --card-bg: #ffffff;
            --body-bg: #f1f5f9;
            --text: #334155;
            --text-light: #64748b;
            --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            --radius: 12px;
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .dark-mode {
            --primary: #4895ef;
            --primary-dark: #3a0ca3;
            --primary-light: #4cc9f0;
            --secondary: #f72585;
            --secondary-dark: #b5179e;
            --accent: #4cc9f0;
            --success: #4ade80;
            --warning: #f59e0b;
            --error: #ef4444;
            --dark: #f8fafc;
            --darker: #e2e8f0;
            --light: #0f172a;
            --gray: #94a3b8;
            --gray-light: #475569;
            --card-bg: #1e293b;
            --body-bg: #0f172a;
            --text: #e2e8f0;
            --text-light: #94a3b8;
            --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.3), 0 2px 4px -1px rgba(0, 0, 0, 0.2);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.3), 0 4px 6px -2px rgba(0, 0, 0, 0.2);
        }

        /* --- ESTILOS BASE Y UTILITIES RESPONSIVE --- */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        html {
            scroll-behavior: smooth;
            touch-action: manipulation;
        }

        body {
            font-family: 'Poppins', sans-serif;
            background-color: var(--body-bg);
            color: var(--text);
            line-height: 1.6;
            transition: var(--transition);
            overflow-x: hidden; /* Evita el scroll horizontal */
            -webkit-text-size-adjust: 100%; /* Previene ajuste automático de texto en iOS */
            text-size-adjust: 100%; /* Previene ajuste automático de texto */
        }

        .container {
            width: 100%;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 1.5rem; /* Padding horizontal para evitar que el contenido toque los bordes */
        }
        
        /* --- HEADER Y NAVEGACIÓN (RESPONSIVE con Flexbox) --- */
        header {
            background-color: var(--card-bg);
            box-shadow: var(--shadow);
            position: sticky;
            top: 0;
            z-index: 100;
            transition: var(--transition);
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1.2rem 0;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            font-size: 1.75rem;
            font-weight: 700;
            color: var(--primary);
            text-decoration: none;
        }

        .logo-icon {
            font-size: 2rem;
            color: var(--primary);
        }

        .header-actions {
            display: flex;
            align-items: center;
            gap: 1.5rem;
        }

        .theme-toggle, .cart-icon {
            background: none;
            border: none;
            font-size: 1.4rem;
            cursor: pointer;
            color: var(--text);
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
            width: 2.5rem;
            height: 2.5rem;
            border-radius: 50%;
            background-color: var(--body-bg);
            position: relative;
        }

        .theme-toggle:hover, .cart-icon:hover {
            background-color: var(--primary);
            color: white;
        }

        .cart-count {
            position: absolute;
            top: -5px;
            right: -5px;
            background-color: var(--secondary);
            color: white;
            border-radius: 50%;
            width: 1.25rem;
            height: 1.25rem;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 0.7rem;
            font-weight: 600;
        }
        
        /* --- BANNER PRINCIPAL Y SECCIÓN HERO (RESPONSIVE) --- */
        .top-banner {
            width: 100%;
            min-height: 400px;
            max-height: 600px;
            overflow: hidden;
            margin-bottom: 0;
            position: relative;
        }
        
        /* La imagen dentro del banner debe ser completamente responsive */
        .top-banner img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            object-position: center;
        }

        .hero {
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
            color: white;
            padding: 5rem 0;
            margin-bottom: 0;
            position: relative;
            overflow: hidden;
            min-height: 400px;
            display: flex;
            align-items: flex-end;
        }

        .hero::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.4); /* Overlay oscuro para el texto */
            z-index: 0;
        }
        
        .dark-mode .hero::before {
            background-color: rgba(0, 0, 0, 0.6); 
        }

        .hero-content {
            text-align: center;
            max-width: 800px;
            margin: 0 auto;
            position: relative;
            z-index: 10;
            padding-top: 2rem;
            width: 100%;
        }

        .hero-title {
            font-size: 3.5rem;
            font-weight: 700;
            margin-bottom: 1.5rem;
            line-height: 1.2;
            color: white; /* Forzar color blanco para contrastar con la imagen */
            text-shadow: 0 2px 4px rgba(0,0,0,0.7);
        }

        .hero-subtitle {
            font-size: 1.25rem;
            margin-bottom: 2.5rem;
            opacity: 0.9;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            color: white; /* Color claro */
            text-shadow: 0 1px 3px rgba(0,0,0,0.5);
        }

        .overlap-box {
           background-color: var(--card-bg);
           padding: 2.5rem;
            border-radius: var(--radius);
            box-shadow: var(--shadow-lg);
            position: relative;
            z-index: 50;
            width: 90%;
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
            margin-top: 2rem;
            transform: translateY(50%); /* Clave para la superposición */
        }

        .overlap-box .hero-actions {
            display: flex;
            gap: 1rem;
            justify-content: center;
            flex-wrap: wrap; /* Permite que los botones se envuelvan en pantallas pequeñas */
            margin: 0;
        }
        
        /* Ajuste para la sección de productos que sigue al banner */
        .section {
            padding: 4rem 0;
            padding-top: 10rem;
            margin-top: -5rem; 
            position: relative; 
            z-index: 1;
        }
        
        /* --- ESTILOS GENERALES Y BOTONES --- */
        .section-header {
            text-align: center;
            margin-bottom: 3rem;
        }

        .section-title {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 1rem;
            color: var(--text);
            position: relative;
            display: inline-block;
        }

        .section-title::after {
            content: '';
            display: block;
            width: 80px;
            height: 4px;
            background: var(--primary);
            margin: 0.75rem auto 0;
            border-radius: 2px;
        }

        .section-subtitle {
            font-size: 1.125rem;
            color: var(--text-light);
            max-width: 600px;
            margin: 0 auto;
        }
        
        /* --- BARRA DE CATEGORÍAS (RESPONSIVE CON SCROLL HORIZONTAL) --- */
        .category-ribbon {
            display: flex;
            overflow-x: auto; /* Permite el scroll horizontal en móvil */
            padding: 0.5rem 0;
            gap: 0.75rem;
            margin-bottom: 2rem;
            -webkit-overflow-scrolling: touch;
            scrollbar-width: none; /* Firefox */
        }

        .category-ribbon::-webkit-scrollbar {
            display: none; /* Chrome, Safari */
        }
        
        .category-button {
            flex-shrink: 0; /* Evita que los botones se encojan */
            background-color: var(--card-bg);
            color: var(--text);
            border: 2px solid var(--gray-light);
            padding: 0.75rem 1.5rem;
            border-radius: 50px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
        }

        .category-button:hover {
            background-color: var(--body-bg);
            border-color: var(--primary);
            color: var(--primary);
        }

        .category-button.active {
            background-color: var(--primary);
            border-color: var(--primary);
            color: white;
            box-shadow: var(--shadow);
        }

        /* Estilos del Buscador */
        .search-container {
            margin-bottom: 3rem;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
        }

        .search-box {
            position: relative;
            display: flex;
            align-items: center;
            background-color: var(--card-bg);
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            padding: 0.5rem 1rem;
            border: 1px solid var(--gray-light);
        }

        #search-input {
            flex-grow: 1;
            padding: 0.5rem 0.5rem 0.5rem 1rem;
            border: none;
            font-size: 1rem;
            background-color: transparent;
            color: var(--text);
        }

        #search-input:focus {
            outline: none;
            border-color: var(--primary);
        }

        .search-icon {
            color: var(--primary);
            font-size: 1.125rem;
        }
        
        .clear-search {
            background: none;
            border: none;
            color: var(--text-light);
            cursor: pointer;
            font-size: 1rem;
            padding: 0.25rem;
            transition: var(--transition);
            display: none; 
            margin-left: 0.5rem;
        }
        
        .clear-search:hover {
            color: var(--error);
        }
        
        /* --- CUADRÍCULA DE PRODUCTOS (RESPONSIVE GRID) --- */
        .products-grid {
            /* Mantiene 280px como mínimo y crea tantas columnas como sea posible */
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 2rem;
        }
        
        /* Product Card Styles */
        .product-card {
            background-color: var(--card-bg);
            border-radius: var(--radius);
            overflow: hidden;
            box-shadow: var(--shadow);
            transition: var(--transition);
            display: flex;
            flex-direction: column;
            height: 100%;
        }

        .product-card:hover {
            transform: translateY(-8px);
            box-shadow: var(--shadow-lg);
        }

        .product-badge {
            position: absolute;
            top: 1rem;
            left: 1rem;
            background-color: var(--secondary);
            color: white;
            padding: 0.25rem 0.75rem;
            border-radius: 50px;
            font-size: 0.75rem;
            font-weight: 600;
            z-index: 1;
        }

        .product-image-container {
            position: relative;
            overflow: hidden;
            height: 200px;
        }

        .product-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: var(--transition);
        }

        .product-card:hover .product-image {
            transform: scale(1.05);
        }

        .product-info {
            padding: 1.5rem;
            flex-grow: 1;
            display: flex;
            flex-direction: column;
        }

        .product-category {
            font-size: 0.875rem;
            color: var(--primary);
            font-weight: 600;
            margin-bottom: 0.5rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .product-title {
            font-size: 1.25rem;
            font-weight: 600;
            margin-bottom: 0.75rem;
            color: var(--text);
            line-height: 1.4;
        }

        .product-description {
            color: var(--text-light);
            margin-bottom: 1.25rem;
            font-size: 0.9rem;
            flex-grow: 1;
        }

        .product-price {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--secondary);
            margin-bottom: 1.25rem;
        }

        .product-actions {
            display: flex;
            gap: 0.75rem;
        }

        /* --- BOTONES (GENERAL) --- */
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            padding: 0.875rem 1.75rem;
            border: none;
            border-radius: var(--radius);
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            text-decoration: none;
        }

        .btn-primary {
            background-color: var(--secondary);
            color: white;
            box-shadow: var(--shadow);
        }

        .btn-primary:hover {
            background-color: var(--secondary-dark);
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        .btn-secondary {
            background-color: transparent;
            color: white;
            border: 2px solid rgba(255, 255, 255, 0.3);
        }

        .btn-secondary:hover {
            background-color: rgba(255, 255, 255, 0.1);
            transform: translateY(-2px);
        }

        .btn-icon {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 2.5rem;
            height: 2.5rem;
            border-radius: var(--radius);
            background-color: var(--body-bg);
            color: var(--text);
            border: none;
            cursor: pointer;
            transition: var(--transition);
        }

        .btn-icon:hover {
            background-color: var(--primary);
            color: white;
        }

        .btn-full {
            flex: 1;
        }
        
        /* --- MODALES (Carrito, Detalle, Checkout) (RESPONSIVE) --- */
        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            display: none;
            backdrop-filter: blur(4px);
        }

        .overlay.active {
            display: block;
        }

        .cart-modal {
            position: fixed;
            top: 0;
            right: -100%;
            width: 100%; /* Ocupa todo el ancho en móvil */
            max-width: 450px; /* Limita el ancho en escritorio */
            height: 100vh;
            background-color: var(--card-bg);
            box-shadow: var(--shadow-lg);
            transition: var(--transition);
            z-index: 1001;
            display: flex;
            flex-direction: column;
        }

        .cart-modal.open {
            right: 0;
        }

        .cart-header {
            padding: 1.5rem;
            border-bottom: 1px solid var(--gray-light);
            display: flex;
            justify-content: space-between;
            align-items: center;
            background-color: var(--primary);
            color: white;
        }

        .cart-title {
            font-size: 1.5rem;
            font-weight: 600;
        }

        .close-cart {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            width: 2.5rem;
            height: 2.5rem;
            border-radius: 50%;
            transition: var(--transition);
        }

        .close-cart:hover {
            background-color: rgba(255, 255, 255, 0.2);
        }

        .cart-items {
            flex: 1;
            overflow-y: auto;
            padding: 1.5rem;
        }

        .cart-item {
            display: flex;
            margin-bottom: 1.5rem;
            padding-bottom: 1.5rem;
            border-bottom: 1px solid var(--gray-light);
        }

        .cart-item-image {
            width: 80px;
            height: 80px;
            object-fit: cover;
            border-radius: var(--radius);
            margin-right: 1rem;
        }

        .cart-item-details {
            flex: 1;
        }

        .cart-item-title {
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: var(--text);
            font-size: 1rem;
        }

        .cart-item-price {
            color: var(--secondary);
            font-weight: 600;
            margin-bottom: 0.75rem;
        }

        .cart-item-quantity {
            display: flex;
            align-items: center;
        }

        .quantity-btn {
            background-color: var(--body-bg);
            color: var(--text);
            border: none;
            width: 2rem;
            height: 2rem;
            border-radius: var(--radius);
            cursor: pointer;
            display: flex;
            justify-content: center;
            align-items: center;
            transition: var(--transition);
        }

        .quantity-btn:hover {
            background-color: var(--primary);
            color: white;
        }

        .quantity-input {
            width: 3rem;
            text-align: center;
            margin: 0 0.5rem;
            border: 1px solid var(--gray-light);
            border-radius: var(--radius);
            padding: 0.25rem;
            background-color: var(--card-bg);
            color: var(--text);
        }

        .quantity-input:focus {
            outline: none;
            border-color: var(--primary);
        }

        .remove-item {
            background: none;
            border: none;
            color: var(--error);
            cursor: pointer;
            margin-top: 0.5rem;
            font-size: 0.875rem;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 0.25rem;
        }

        .remove-item:hover {
            color: var(--secondary);
        }

        .empty-cart {
            text-align: center;
            padding: 3rem 1.5rem;
            color: var(--text-light);
        }

        .empty-cart-icon {
            font-size: 3rem;
            margin-bottom: 1rem;
            color: var(--gray-light);
        }

        .cart-footer {
            padding: 1.5rem;
            border-top: 1px solid var(--gray-light);
            background-color: var(--card-bg);
        }

        .cart-total {
            display: flex;
            justify-content: space-between;
            font-size: 1.25rem;
            font-weight: 700;
            margin-bottom: 1.5rem;
            color: var(--text);
        }

        .checkout-btn {
            background-color: var(--success);
            color: white;
            border: none;
            padding: 1rem;
            border-radius: var(--radius);
            width: 100%;
            font-size: 1.125rem;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 0.5rem;
            box-shadow: var(--shadow);
        }

        .checkout-btn:hover {
            background-color: #22c55e;
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        /* Product Detail Modal */
        .product-detail-modal {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0.9);
            width: 90%; /* Responsive: 90% del ancho */
            max-width: 900px;
            max-height: 90vh;
            background-color: var(--card-bg);
            border-radius: var(--radius);
            box-shadow: var(--shadow-lg);
            z-index: 1002;
            opacity: 0;
            visibility: hidden;
            transition: var(--transition);
            overflow-y: auto;
        }

        .product-detail-modal.active {
            opacity: 1;
            visibility: visible;
            transform: translate(-50%, -50%) scale(1);
        }

        .product-detail-content {
            display: flex;
            flex-direction: column;
            padding: 0;
        }

        .product-detail-header {
            padding: 1.5rem;
            border-bottom: 1px solid var(--gray-light);
            display: flex;
            justify-content: space-between;
            align-items: center;
            background-color: var(--primary);
            color: white;
        }

        .close-detail {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            width: 2.5rem;
            height: 2.5rem;
            border-radius: 50%;
            transition: var(--transition);
        }

        .close-detail:hover {
            background-color: rgba(255, 255, 255, 0.2);
        }

        .product-detail-body {
            display: flex;
            flex-direction: column; /* Columna por defecto (móvil) */
            padding: 2rem;
        }

        @media (min-width: 768px) {
            .product-detail-body {
                flex-direction: row; /* Fila en escritorio */
                gap: 2rem;
            }
        }
        
        /* Product Detail Image */
        .product-detail-image {
            flex: 1;
            display: flex;
            justify-content: center;
            align-items: flex-start;
        }

        .product-detail-image img {
            width: 100%;
            max-width: 400px;
            border-radius: var(--radius);
            box-shadow: var(--shadow);
        }

        /* Product Detail Info */
        .product-detail-info {
            flex: 1;
            display: flex;
            flex-direction: column;
        }

        .product-detail-title {
            font-size: 1.75rem;
            font-weight: 700;
            margin-bottom: 1rem;
            color: var(--text);
        }

        .product-detail-price {
            font-size: 1.75rem;
            font-weight: 700;
            color: var(--secondary);
            margin-bottom: 1.5rem;
        }

        .product-detail-description {
            color: var(--text-light);
            margin-bottom: 1.5rem;
            line-height: 1.6;
        }

        .product-detail-features {
            margin-bottom: 2rem;
        }

        .product-detail-features h3 {
            font-size: 1.25rem;
            margin-bottom: 1rem;
            color: var(--text);
        }

        .product-detail-features ul {
            list-style: none;
            padding-left: 0;
        }

        .product-detail-features li {
            position: relative;
            padding-left: 1.5rem;
            margin-bottom: 0.5rem;
            color: var(--text-light);
        }

        .product-detail-features li::before {
            content: '✓';
            position: absolute;
            left: 0;
            color: var(--success);
            font-weight: bold;
        }

        .quantity-selector {
            margin-bottom: 2rem;
        }

        .quantity-selector label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
            color: var(--text);
        }

        .product-detail-actions {
            display: flex;
            gap: 1rem;
        }

        /* General Modal (For Policy/Terms) */
        .general-modal {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0.9);
            width: 90%;
            max-width: 700px;
            max-height: 90vh;
            background-color: var(--card-bg);
            border-radius: var(--radius);
            box-shadow: var(--shadow-lg);
            z-index: 1002;
            opacity: 0;
            visibility: hidden;
            transition: var(--transition);
            overflow-y: auto;
        }

        .general-modal.active {
            opacity: 1;
            visibility: visible;
            transform: translate(-50%, -50%) scale(1);
        }
        
        .general-modal-content {
            padding: 2rem;
        }
        
        .general-modal-header {
            padding: 1.5rem;
            border-bottom: 1px solid var(--gray-light);
            display: flex;
            justify-content: space-between;
            align-items: center;
            background-color: var(--primary);
            color: white;
        }
        
        .general-modal-header h2 {
            margin: 0;
        }
        
        .close-general-modal {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            width: 2.5rem;
            height: 2.5rem;
            border-radius: 50%;
            transition: var(--transition);
        }

        .close-general-modal:hover {
            background-color: rgba(255, 255, 255, 0.2);
        }

        .general-modal-body {
            padding: 2rem 1.5rem;
            max-height: calc(90vh - 120px);
            overflow-y: auto;
        }
        
        .general-modal-body h3 {
            color: var(--primary);
            margin-top: 1.5rem;
            margin-bottom: 0.75rem;
        }
        
        .general-modal-body p, .general-modal-body ul {
            margin-bottom: 1rem;
            color: var(--text);
        }
        /* End General Modal */

        /* Checkout Modal */
        .checkout-modal {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0.9);
            width: 90%;
            max-width: 500px;
            background-color: var(--card-bg);
            border-radius: var(--radius);
            box-shadow: var(--shadow-lg);
            z-index: 1002;
            padding: 2rem;
            opacity: 0;
            visibility: hidden;
            transition: var(--transition);
        }

        .checkout-modal.active {
            opacity: 1;
            visibility: visible;
            transform: translate(-50%, -50%) scale(1);
        }

        .checkout-modal h2 {
            margin-bottom: 1.5rem;
            color: var(--text);
            text-align: center;
            font-size: 1.75rem;
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            color: var(--text);
            font-weight: 500;
        }

        .form-control {
            width: 100%;
            padding: 0.875rem 1rem;
            border: 1px solid var(--gray-light);
            border-radius: var(--radius);
            background-color: var(--card-bg);
            color: var(--text);
            font-size: 1rem;
            transition: var(--transition);
        }

        .form-control:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(67, 97, 238, 0.2);
        }

        .modal-actions {
            display: flex;
            gap: 1rem;
            margin-top: 2rem;
        }

        .btn-outline {
            background-color: transparent;
            border: 2px solid var(--gray-light);
            color: var(--text);
        }

        .btn-outline:hover {
            background-color: var(--body-bg);
        }

        /* --- FOOTER (RESPONSIVE GRID) --- */
        footer {
            background-color: var(--card-bg);
            color: var(--text);
            padding: 4rem 0 2rem;
            margin-top: 4rem;
            box-shadow: 0 -4px 6px -1px rgba(0, 0, 0, 0.05), 0 -2px 4px -1px rgba(0, 0, 0, 0.03);
            transition: var(--transition);
        }

        .footer-content {
            /* Desktop/Tablet grande: 4 columnas */
            display: grid;
            grid-template-columns: 2fr 1fr 1fr 1fr; 
            gap: 2rem;
            border-bottom: 1px solid var(--gray-light);
            padding-bottom: 3rem;
            margin-bottom: 2rem;
        }

        .footer-logo-section .logo {
            margin-bottom: 1rem;
        }

        .footer-logo-section p {
            font-size: 0.9rem;
            color: var(--text-light);
            margin-bottom: 1.5rem;
        }

        .social-links {
            display: flex;
            gap: 1rem;
        }

        .social-link {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 2.5rem;
            height: 2.5rem;
            border-radius: 50%;
            background-color: var(--body-bg);
            color: var(--primary);
            font-size: 1.1rem;
            transition: var(--transition);
            text-decoration: none;
        }

        .social-link:hover {
            background-color: var(--primary);
            color: white;
        }

        .footer-column h4 {
            font-size: 1.125rem;
            font-weight: 600;
            margin-bottom: 1.5rem;
            color: var(--text);
            position: relative;
        }
        
        .footer-column h4::after {
            content: '';
            display: block;
            width: 30px;
            height: 2px;
            background: var(--secondary);
            margin-top: 0.5rem;
            border-radius: 1px;
        }


        .footer-column ul {
            list-style: none;
            padding: 0;
        }

        .footer-column ul li {
            margin-bottom: 0.75rem;
        }

        .footer-column ul li a {
            color: var(--text-light);
            text-decoration: none;
            transition: var(--transition);
            font-size: 0.95rem;
        }

        .footer-column ul li a:hover {
            color: var(--primary);
        }
        
        .contact-info li {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .contact-info li i {
            color: var(--primary);
            font-size: 1rem;
        }

        .footer-bottom {
            text-align: center;
            font-size: 0.875rem;
            color: var(--text-light);
        }
        
        /* --- NOTIFICACIÓN TOAST --- */
        #toast {
            visibility: hidden;
            min-width: 250px;
            margin-left: -125px;
            background-color: var(--dark);
            color: #fff;
            text-align: center;
            border-radius: var(--radius);
            padding: 16px;
            position: fixed;
            z-index: 10000;
            left: 50%;
            bottom: 30px;
            font-size: 17px;
            box-shadow: var(--shadow-lg);
            transition: all 0.5s ease-in-out;
        }

        #toast.show {
            visibility: visible;
            animation: fadein 0.5s, fadeout 0.5s 2.5s;
        }

        @keyframes fadein {
            from {bottom: 0; opacity: 0;}
            to {bottom: 30px; opacity: 1;}
        }

        @keyframes fadeout {
            from {bottom: 30px; opacity: 1;}
            to {bottom: 0; opacity: 0;}
        }


        /* ======================================= */
        /* --- MEDIA QUERIES (RESPONSIVE RULES) --- */
        /* ======================================= */

        /* Tablets grandes y medianas (992px y menos) */
        @media (max-width: 992px) {
            .footer-content {
                grid-template-columns: 2fr 1fr 1fr; /* 3 columnas */
            }
            .footer-column:nth-child(4) {
                grid-column: 2 / span 2; /* Última columna ocupa dos espacios abajo */
            }
        }

        /* Tablets pequeñas y dispositivos horizontales (768px y menos) */
        @media (max-width: 768px) {
            .hero {
                padding: 4rem 0;
            }
            .hero-title {
                font-size: 2.5rem;
            }
            .hero-subtitle {
                font-size: 1.1rem;
            }
            .section {
                padding: 3rem 0;
                padding-top: 8rem; /* Menor padding superior en móvil */
                margin-top: -3rem; /* Menor margen negativo en móvil */
            }
            .overlap-box {
                padding: 1.5rem;
                transform: translateY(30%); /* Menor superposición en móvil */
            }
            .top-banner {
                min-height: 250px;
            }
            .product-detail-body {
                gap: 1.5rem;
            }
        }

        /* Teléfonos grandes (640px y menos): Cambio a diseños de una columna */
        @media (max-width: 640px) {
            .hero {
                padding: 3rem 0;
            }
            .hero-title {
                font-size: 2rem;
            }
            .overlap-box .hero-actions {
                flex-direction: column; /* Botones de hero apilados */
                align-items: center;
            }
            .overlap-box .btn {
                width: 100%;
                max-width: 300px;
            }
            .products-grid {
                grid-template-columns: 1fr; /* Una sola columna para la cuadrícula de productos */
            }
            .section {
                padding: 3rem 0;
            }
            .footer-content {
                grid-template-columns: 1fr; /* Una sola columna para el footer */
            }
        }

        /* Teléfonos pequeños (480px y menos) */
        @media (max-width: 480px) {
            .container {
                padding: 0 1rem; /* Menor padding en los bordes */
            }
            .header-content {
                padding: 1rem 0;
            }
            .logo {
                font-size: 1.5rem;
            }
            .product-actions {
                flex-direction: column; /* Botones de producto apilados */
            }
            .btn-full {
                width: 100%;
            }
            .cart-item {
                flex-direction: column; /* Items del carrito apilados */
            }
            .cart-item-image {
                width: 100%;
                height: 150px;
                margin-right: 0;
                margin-bottom: 1rem;
            }
        }

    </style>
</head>
<body>
    
    <header>
        <div class="container">
            <div class="header-content">
                <a href="#" class="logo">
                    <i class="fas fa-laptop-code logo-icon"></i>
                    <span>ECHO Technology Store</span>
                </a>
                <div class="header-actions">
                    <button class="theme-toggle" id="theme-toggle" aria-label="Cambiar tema">
                        <i class="fas fa-moon"></i>
                    </button>
                    <div class="cart-icon" id="cart-icon">
                        <i class="fas fa-shopping-cart"></i>
                        <span class="cart-count" id="cart-count">0</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <main>
        
        <section class="top-banner">
            <img src="banner pr.JPG" alt="Banner principal de la tienda con productos tecnológicos">
        </section>

        <div class="section-header">
            <div class="container">
                <div class="hero-content">
                    <h1 class="section-title">¡Lo mejor en Tecnología y Accesorios!</h1>
                    <p class="section-subtitle">Descubre nuestra selección de cargadores y cables de alta calidad de las marcas LDNIO y ECCO. ¡Potencia tu vida digital!</p>
                </div>
            </div>
        </div>
        
        <section class="section" id="productos">
            <div class="container">
                <div class="overlap-box">
                    <div class="hero-actions">
                         <a href="#productos" class="btn btn-primary" id="scroll-to-products">
                            <i class="fas fa-bolt"></i> Explorar Productos
                        </a>
                        <button class="btn btn-secondary" id="open-cart-hero">
                            <i class="fas fa-shopping-basket"></i> Ver Carrito
                        </button>
                    </div>
                </div>
                
                <div class="section-header">
                    <h2 class="section-title">Nuestra Colección</h2>
                    <p class="section-subtitle">Encuentra el producto perfecto con nuestros filtros de categoría y el potente buscador.</p>
                </div>

                <div class="category-ribbon" id="category-ribbon">
                    </div>

                <div class="search-container">
                    <div class="search-box">
                        <i class="fas fa-search search-icon"></i>
                        <input type="text" id="search-input" placeholder="Buscar por nombre, descripción o marca...">
                        <button class="clear-search" id="clear-search" aria-label="Limpiar búsqueda">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                </div>

                <div class="products-grid" id="products-container">
                    <p style="text-align: center; grid-column: 1/-1;">Cargando productos...</p>
                </div>
            </div>
        </section>
        
    </main>

    <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-column footer-logo-section">
                    <a href="#" class="logo">
                        <i class="fas fa-laptop-code logo-icon"></i>
                        <span>ECHO Technology Store</span>
                    </a>
                    <p>Tu tienda virtual de confianza para accesorios tecnológicos de alta calidad. Productos 100% originales.</p>
                    <div class="social-links">
                        <a href="#" class="social-link" target="_blank" aria-label="WhatsApp">
                            <i class="fab fa-whatsapp"></i>
                        </a>
                        <a href="#" class="social-link" target="_blank" aria-label="Instagram">
                            <i class="fab fa-instagram"></i>
                        </a>
                        <a href="#" class="social-link" target="_blank" aria-label="Facebook">
                            <i class="fab fa-facebook-f"></i>
                        </a>
                    </div>
                </div>
                
                <div class="footer-column">
                    <h4>Enlaces Rápidos</h4>
                    <ul>
                        <li><a href="#productos">Tienda</a></li>
                        <li><a href="#" id="open-cart-footer">Ver Carrito</a></li>
                        <li><a href="#productos">Categorías</a></li>
                        <li><a href="#" id="privacy-policy-link">Política de Privacidad</a></li>
                        <li><a href="#" id="terms-of-service-link">Términos de Servicio</a></li>
                    </ul>
                </div>
                
                <div class="footer-column">
                    <h4>Contacto</h4>
                    <ul class="contact-info">
                        <li><i class="fas fa-phone"></i><span>+593 96 787 9068</span></li>
                        <li><i class="fas fa-envelope"></i><span>contacto@echo.com</span></li>
                        <li><i class="fas fa-map-marker-alt"></i><span>Chone, Ecuador</span></li>
                    </ul>
                </div>
                
                <div class="footer-column">
                    <h4>Métodos de Pago</h4>
                    <ul class="contact-info">
                        <li><i class="fas fa-money-bill-wave"></i><span>Efectivo (Contra Entrega)</span></li>
                        <li><i class="fas fa-university"></i><span>Transferencia Bancaria - Banco Pichincha</span></li>
                        </ul>
                </div>
            </div>
            <div class="footer-bottom">
                &copy; 2025 ECHO Technology Store. Todos los derechos reservados.
            </div>
        </div>
    </footer>

    <div class="overlay" id="overlay"></div>

    <div class="cart-modal" id="cart-modal">
        <div class="cart-header">
            <h2 class="cart-title">Tu Carrito de Compras</h2>
            <button class="close-cart" id="close-cart" aria-label="Cerrar carrito">
                <i class="fas fa-times"></i>
            </button>
        </div>
        <div class="cart-items" id="cart-items">
            <div class="empty-cart" id="empty-cart">
                <i class="fas fa-shopping-basket empty-cart-icon"></i>
                <p>Tu carrito está vacío.</p>
                <a href="#productos" class="btn btn-primary" onclick="closeCartModal()">
                    <i class="fas fa-store"></i> Ir a la Tienda
                </a>
            </div>
        </div>
        <div class="cart-footer">
            <div class="cart-total">
                <span>Total:</span>
                <span id="cart-total">$0.00</span>
            </div>
            <button class="checkout-btn" id="checkout-btn" disabled>
                <i class="fab fa-whatsapp"></i> Finalizar Compra por WhatsApp
            </button>
        </div>
    </div>
    
    <div class="checkout-modal" id="checkout-modal">
        <h2>Detalles de Envío</h2>
        <form id="checkout-form">
            <div class="form-group">
                <label for="name">Nombre Completo *</label>
                <input type="text" id="name" class="form-control" required>
            </div>
            <div class="form-group">
                <label for="phone">Número de Teléfono (WhatsApp) *</label>
                <input type="tel" id="phone" class="form-control" placeholder="Ej: 593967879068" required>
            </div>
            <div class="form-group">
                <label for="address">Dirección de Entrega *</label>
                <input type="text" id="address" class="form-control" required>
            </div>
            <div class="form-group">
                <label for="city">Ciudad/Cantón *</label>
                <input type="text" id="city" class="form-control" required>
            </div>
            <div class="form-group">
                <label for="notes">Notas Adicionales (Opcional)</label>
                <textarea id="notes" class="form-control" rows="3"></textarea>
            </div>
            <div class="modal-actions">
                <button type="button" class="btn btn-outline btn-full" id="cancel-checkout">
                    <i class="fas fa-arrow-left"></i> Volver al Carrito
                </button>
                <button type="submit" class="btn btn-primary btn-full">
                    <i class="fab fa-whatsapp"></i> Enviar Pedido por WhatsApp
                </button>
            </div>
        </form>
    </div>

    <div class="product-detail-modal" id="product-detail-modal">
        <div class="product-detail-header">
            <h2 id="product-detail-modal-title">Detalles del Producto</h2>
            <button class="close-detail" id="close-detail" aria-label="Cerrar detalles">
                <i class="fas fa-times"></i>
            </button>
        </div>
        <div class="product-detail-body" id="product-detail-body">
            </div>
    </div>
    
    <div class="general-modal" id="general-modal">
        <div class="general-modal-header">
            <h2 id="general-modal-title"></h2>
            <button class="close-general-modal" id="close-general-modal" aria-label="Cerrar">
                <i class="fas fa-times"></i>
            </button>
        </div>
        <div class="general-modal-body" id="general-modal-body">
            </div>
    </div>


    <div id="toast">
        <span id="toast-message"></span>
    </div>

    <script>
        // --- 1. BASE DE DATOS DE PRODUCTOS ---
        const products = [
            { 
                id: 1, 
                name: "CARGADOR LDNIO A2203 Doble USB (2.4A)", 
                price: 3.50, 
                image: "cargador-ldnio-a2203.jpg", 
                description: "Cargador de pared LDNIO A2203 de alta calidad con doble puerto USB-A y salida máxima de 2.4A. Ideal para carga diaria y segura.",
                features: [ 
                    "Puertos: 2x USB-A", 
                    "Salida: 2.4A (máx.)", 
                    "Tecnología: Auto-ID (Identificación automática)", 
                    "Color: Blanco", 
                    "Marca: LDNIO" 
                ], 
                category: "Cargadores de Pared", 
                badge: null 
            },
            { 
                id: 2, 
                name: "CABLE LDNIO LS841 Tipo C Blanco (1M, 25W)", 
                price: 1.00, 
                image: "cable-ldnio-ls841-type-c-b.jpg", 
                description: "Cable de carga rápida LDNIO LS841 de 1 metro, USB-A a Tipo C. Soporta hasta 25W. Diseño duradero y anti-enredos.",
                features: [ 
                    "Conexión: USB-A a Tipo C (USB-C)", 
                    "Longitud: 1 metro", 
                    "Potencia de Carga: 25W", 
                    "Color: Blanco", 
                    "Marca: LDNIO" 
                ], 
                category: "Cables y Accesorios", 
                badge: null 
            },
            { 
                id: 3, 
                name: "CABLE LDNIO LS841 Micro-USB (1M, 25W)", 
                price: 1.00, 
                image: "cable-ldnio-ls841-micro-usb.jpg", 
                description: "Cable de carga rápida LDNIO LS841 de 1 metro, USB-A a Micro-USB (V8). Soporta hasta 25W, compatible con la mayoría de dispositivos Android antiguos.",
                features: [ 
                    "Conexión: USB-A a Micro-USB (V8)", 
                    "Longitud: 1 metro", 
                    "Potencia de Carga: 25W", 
                    "Color: Blanco", 
                    "Marca: LDNIO" 
                ], 
                category: "Cables y Accesorios", 
                badge: null 
            },
            { 
                id: 4, 
                name: "CABLE LDNIO LS841 USB-C Negro (1M, 25W)", 
                price: 1.00, 
                image: "cable-ldnio-ls841-type-c-n.jpg", 
                description: "Cable de carga rápida LDNIO LS841 de 1 metro, USB-A a Tipo C. Soporta hasta 25W. Elegante color negro.",
                features: [ 
                    "Conexión: USB-A a Tipo C (USB-C)", 
                    "Longitud: 1 metro", 
                    "Potencia de Carga: 25W", 
                    "Color: Negro", 
                    "Marca: LDNIO" 
                ], 
                category: "Cables y Accesorios", 
                badge: null 
            },
            { 
                id: 5, 
                name: "CARGADOR LDNIO A4405 4 USB Auto-ID", 
                price: 5.00, 
                image: "cargador-ldnio-a4405.jpg", 
                description: "Cargador potente de pared con 4 puertos USB (4.4A total). Perfecto para cargar múltiples dispositivos simultáneamente. Incluye luz LED nocturna.",
                features: [ 
                    "Puertos: 4x USB-A", 
                    "Salida: 4.4A (máx.)", 
                    "Tecnología: Auto-ID", 
                    "Luz Nocturna: Sí", 
                    "Marca: LDNIO" 
                ], 
                category: "Cargadores de Pared", 
                badge: "4 Puertos" 
            },
            { 
                id: 6, 
                name: "CARGADOR LDNIO A1304Q USB QC3.0 (30W)", 
                price: 4.50, 
                image: "cargador-ldnio-a1304q.jpg", 
                description: "Cargador de pared de carga rápida con tecnología Quick Charge 3.0. Ideal para dispositivos compatibles con alta velocidad de carga.",
                features: [ 
                    "Puertos: 1x USB-A (QC 3.0)", 
                    "Potencia Máxima: 30W", 
                    "Tecnología: Quick Charge 3.0", 
                    "Color: Blanco", 
                    "Marca: LDNIO" 
                ], 
                category: "Cargadores de Pared", 
                badge: "30W" 
            },
            { 
                id: 7, 
                name: "CARGADOR LDNIO C304 2 USB para Auto (3.4A)", 
                price: 2.50, 
                image: "cargador-ldnio-c304.jpg", 
                description: "Cargador de coche LDNIO C304 con doble puerto USB y 3.4A de salida total, ideal para el vehículo. Carga rápida y segura en el camino.",
                features: [ 
                    "Puertos: 2x USB-A", 
                    "Salida: 3.4A (máx.)", 
                    "Tecnología: Auto-ID", 
                    "Color: Blanco/Plateado", 
                    "Marca: LDNIO" 
                ], 
                category: "Cargadores de Auto", 
                badge: null 
            },
            { 
                id: 8, 
                name: "CABLE ECCO EC-25 Tipo C (1M, 65W)", 
                price: 1.50, 
                image: "cable-ecco-ec25-type-c.jpg", 
                description: "Cable ECCO EC-25 de 1 metro, USB-A a Tipo C. Soporte de carga súper rápida de hasta 65W. Alta durabilidad y rendimiento.",
                features: [ 
                    "Conexión: USB-A a Tipo C (USB-C)", 
                    "Longitud: 1 metro", 
                    "Potencia de Carga: 65W", 
                    "Marca: ECCO" 
                ], 
                category: "Cables y Accesorios", 
                badge: "Súper Carga" 
            },
            { 
                id: 9, 
                name: "CABLE ECCO EC-25 Lightning (1M, 45W)", 
                price: 1.50, 
                image: "cable-ecco-ec25-lightning.jpg", 
                description: "Cable ECCO EC-25 de 1 metro, USB-A a Lightning. Soporta hasta 45W. Certificado para dispositivos Apple.",
                features: [ 
                    "Conexión: USB-A a Lightning (IPH)", 
                    "Longitud: 1 metro", 
                    "Potencia de Carga: 45W", 
                    "Marca: ECCO" 
                ], 
                category: "Cables y Accesorios", 
                badge: null 
            },
            { 
                id: 10, 
                name: "CABLE ECCO EC-41 4EN1 (65W, Múltiples Conectores)", 
                price: 2.00, 
                image: "cable-ecco-ec41-4in1.jpg", 
                description: "Cable multipropósito 4-en-1 ECCO EC-41 de 65W. Incluye adaptadores para USB-C y Lightning. La solución universal de carga.",
                features: [ 
                    "Tipo: 4 en 1 (Múltiples combinaciones)", 
                    "Potencia Máxima: 65W", 
                    "Conectores: USB-C, USB-A, Lightning (IPH)", 
                    "Marca: ECCO" 
                ], 
                category: "Cables y Accesorios", 
                badge: "Universal" 
            },
            { 
                id: 11, 
                name: "SOPORTE DE ESCRITORIO AJUSTABLE", 
                price: 7.50, 
                image: "soporte-escritorio.jpg", 
                description: "Soporte de aluminio plegable y ajustable para celulares y tablets. Mejora tu postura y productividad.",
                features: [ 
                    "Material: Aleación de Aluminio", 
                    "Ajustable: Ángulo y Altura", 
                    "Compatibilidad: Universal (hasta 12 pulgadas)", 
                    "Uso: Escritorio/Oficina" 
                ], 
                category: "Soportes y Bases", 
                badge: "Nuevo" 
            },
            { 
                id: 12, 
                name: "ADAPTADOR USB-C a HDMI 4K", 
                price: 5.00, 
                image: "adaptador-usbc-hdmi.jpg", 
                description: "Adaptador compacto USB-C a HDMI que soporta resolución 4K a 60Hz. Perfecto para proyectar desde laptops o móviles.",
                features: [ 
                    "Conexión: USB-C (Entrada) a HDMI (Salida)", 
                    "Resolución Máx: 4K @ 60Hz", 
                    "Uso: Plug and Play (No requiere drivers)", 
                    "Material: Carcasa de Aluminio" 
                ], 
                category: "Adaptadores y Hubs", 
                badge: null 
            }
            
        ];
        
        // --- 2. VARIABLES GLOBALES DE LA TIENDA ---
        let cart = [];
        let currentCategory = 'Todos'; // Categoría activa
        let isCartOpen = false;

        // --- 3. SELECCIÓN DE ELEMENTOS DEL DOM ---
        const productsContainer = document.getElementById('products-container');
        const categoryRibbon = document.getElementById('category-ribbon');
        const cartModal = document.getElementById('cart-modal');
        const overlay = document.getElementById('overlay');
        const closeCart = document.getElementById('close-cart');
        const cartIcon = document.getElementById('cart-icon');
        const openCartHero = document.getElementById('open-cart-hero');
        const cartCount = document.getElementById('cart-count');
        const cartItems = document.getElementById('cart-items');
        const emptyCart = document.getElementById('empty-cart');
        const cartTotal = document.getElementById('cart-total');
        const checkoutBtn = document.getElementById('checkout-btn');
        const checkoutModal = document.getElementById('checkout-modal');
        const checkoutForm = document.getElementById('checkout-form');
        const cancelCheckout = document.getElementById('cancel-checkout');
        const themeToggle = document.getElementById('theme-toggle');
        const productDetailModal = document.getElementById('product-detail-modal');
        const productDetailBody = document.getElementById('product-detail-body');
        const closeDetail = document.getElementById('close-detail');
        const toast = document.getElementById('toast');
        const toastMessage = document.getElementById('toast-message');
        const searchInput = document.getElementById('search-input');
        const clearSearchBtn = document.getElementById('clear-search');
        // Elementos del Modal General
        const generalModal = document.getElementById('general-modal');
        const generalModalTitle = document.getElementById('general-modal-title');
        const generalModalBody = document.getElementById('general-modal-body');
        const closeGeneralModal = document.getElementById('close-general-modal');
        const privacyPolicyLink = document.getElementById('privacy-policy-link');
        const termsOfServiceLink = document.getElementById('terms-of-service-link');
        const openCartFooter = document.getElementById('open-cart-footer');
        
        // --- 4. INICIALIZACIÓN ---
        function initStore() {
            loadCartFromStorage();
            updateCart();
            renderCategories();
            filterAndRenderProducts();

            // Event listeners para Modales y Carrito
            cartIcon.addEventListener('click', openCart);
            openCartHero.addEventListener('click', (e) => { 
                e.preventDefault(); 
                openCart(); 
            });
            openCartFooter.addEventListener('click', (e) => { 
                e.preventDefault(); 
                openCart(); 
            });
            closeCart.addEventListener('click', closeCartModal);
            overlay.addEventListener('click', closeAllModals);
            checkoutBtn.addEventListener('click', openCheckoutModal);
            cancelCheckout.addEventListener('click', closeCheckoutModal);
            checkoutForm.addEventListener('submit', processCheckout);
            themeToggle.addEventListener('click', toggleTheme);
            closeDetail.addEventListener('click', closeProductDetail);

            // Event listeners para Modales de Política/Términos
            closeGeneralModal.addEventListener('click', closeGeneralModalHandler);
            privacyPolicyLink.addEventListener('click', (e) => {
                e.preventDefault();
                openGeneralModal('Política de Privacidad', getPrivacyPolicyContent());
            });
            termsOfServiceLink.addEventListener('click', (e) => {
                e.preventDefault();
                openGeneralModal('Términos de Servicio', getTermsOfServiceContent());
            });

            // Event listeners para el buscador
            searchInput.addEventListener('input', filterAndRenderProducts);
            clearSearchBtn.addEventListener('click', clearSearch);

            // Cargar tema desde localStorage
            const savedTheme = localStorage.getItem('theme');
            if (savedTheme === 'dark') {
                document.body.classList.add('dark-mode');
                themeToggle.innerHTML = '<i class="fas fa-sun"></i>';
            } else {
                themeToggle.innerHTML = '<i class="fas fa-moon"></i>';
            }
        }

        // --- 5. LÓGICA DE FILTROS Y BÚSQUEDA ---
        
        // 1. Obtener lista única de categorías
        function getCategories() {
            const categories = products.map(p => p.category);
            return ['Todos', ...new Set(categories)];
        }

        // 2. Renderizar botones de categorías
        function renderCategories() {
            const categories = getCategories();
            categoryRibbon.innerHTML = ''; // Limpiar cinta

            categories.forEach(category => {
                const button = document.createElement('button');
                button.className = `category-button ${category === currentCategory ? 'active' : ''}`;
                button.textContent = category;
                button.addEventListener('click', () => {
                    currentCategory = category;
                    // Remover 'active' de todos
                    document.querySelectorAll('.category-button').forEach(btn => btn.classList.remove('active'));
                    // Añadir 'active' al botón clickeado
                    button.classList.add('active');
                    filterAndRenderProducts();
                });
                categoryRibbon.appendChild(button);
            });
        }
        
        // 3. Renderizar productos en el contenedor
        function renderProducts(productsList) {
            productsContainer.innerHTML = ''; // Limpiar contenedor
            
            // Si el filtro de búsqueda está activo y no hay resultados.
            if (searchInput.value.trim().length > 0 && productsList.length === 0 && currentCategory !== 'Todos') {
                productsContainer.innerHTML = `
                    <div style="text-align: center; padding: 2rem; color: var(--text-light); grid-column: 1/-1;">
                        <i class="fas fa-search-minus" style="font-size: 2rem; margin-bottom: 0.5rem;"></i>
                        <p>No se encontraron productos que coincidan con su filtro y/o búsqueda.</p>
                    </div>
                `;
                return;
            } else if (productsList.length === 0) {
                 productsContainer.innerHTML = `
                    <div style="text-align: center; padding: 2rem; color: var(--text-light); grid-column: 1/-1;">
                        <i class="fas fa-boxes" style="font-size: 2rem; margin-bottom: 0.5rem;"></i>
                        <p>No hay productos disponibles en este momento.</p>
                    </div>
                `;
                return;
            }

            // Renderizar todos los productos en secuencia
            productsList.forEach(product => {
                productsContainer.appendChild(createProductCard(product));
            });
            
            // Re-añadir event listeners a los botones de producto
            attachProductCardListeners();
        }

        // 4. Función central de filtrado (combina búsqueda y categoría)
        function filterAndRenderProducts() {
            const searchTerm = searchInput.value.trim().toLowerCase();
            
            if (searchTerm.length > 0) {
                clearSearchBtn.style.display = 'flex';
            } else {
                clearSearchBtn.style.display = 'none';
            }
            
            const filteredProducts = products.filter(product => {
                // Filtro de búsqueda
                const matchesSearch = product.name.toLowerCase().includes(searchTerm) || 
                                      product.description.toLowerCase().includes(searchTerm) ||
                                      product.category.toLowerCase().includes(searchTerm);

                // Filtro de categoría
                const matchesCategory = currentCategory === 'Todos' || product.category === currentCategory;

                return matchesSearch && matchesCategory;
            });

            renderProducts(filteredProducts);
        }

        // 5. Limpiar búsqueda
        function clearSearch() {
            searchInput.value = '';
            filterAndRenderProducts();
        }

        // --- 6. LÓGICA DE TARJETA DE PRODUCTO ---

        // Crea el HTML de una tarjeta de producto
        function createProductCard(product) {
            const productCard = document.createElement('div');
            productCard.className = 'product-card';
            
            let badgeHTML = '';
            if (product.badge) {
                badgeHTML = `<span class="product-badge">${product.badge}</span>`;
            }
            
            productCard.innerHTML = `
                <div class="product-image-container">
                    ${badgeHTML}
                    <img src="${product.image}" alt="${product.name}" class="product-image" onerror="this.onerror=null;this.src='https://via.placeholder.com/280x200?text=IMG'">
                </div>
                <div class="product-info">
                    <div class="product-category">${product.category}</div>
                    <h3 class="product-title">${product.name}</h3>
                    <p class="product-description">${product.description}</p>
                    <div class="product-price">$${product.price.toFixed(2)}</div>
                    <div class="product-actions">
                        <button class="btn btn-primary btn-full add-to-cart" data-id="${product.id}">
                            <i class="fas fa-cart-plus"></i> Añadir
                        </button>
                        <button class="btn-icon view-details" data-id="${product.id}" title="Ver detalles">
                            <i class="fas fa-eye"></i>
                        </button>
                    </div>
                </div>
            `;
            return productCard;
        }

        // Añadir event listeners a los botones de producto
        function attachProductCardListeners() {
            document.querySelectorAll('.add-to-cart').forEach(button => {
                button.addEventListener('click', (e) => {
                    const productId = parseInt(e.currentTarget.getAttribute('data-id'));
                    addToCart(productId, 1);
                });
            });
            
            document.querySelectorAll('.view-details').forEach(button => {
                button.addEventListener('click', (e) => {
                    const productId = parseInt(e.currentTarget.getAttribute('data-id'));
                    showProductDetails(productId);
                });
            });
        }
        
        // --- 7. LÓGICA DEL CARRITO (Cart) ---

        // Cargar carrito desde localStorage
        function loadCartFromStorage() {
            const savedCart = localStorage.getItem('echo_tech_cart');
            if (savedCart) {
                cart = JSON.parse(savedCart);
            }
        }

        // Guardar carrito en localStorage
        function saveCartToStorage() {
            localStorage.setItem('echo_tech_cart', JSON.stringify(cart));
        }

        // Añadir producto al carrito
        function addToCart(productId, quantity) {
            const product = products.find(p => p.id === productId);
            if (!product) return;

            const existingItem = cart.find(item => item.id === productId);

            if (existingItem) {
                existingItem.quantity += quantity;
            } else {
                cart.push({
                    id: product.id,
                    name: product.name,
                    price: product.price,
                    image: product.image,
                    quantity: quantity
                });
            }
            updateCart();
            showToast(`"${product.name}" añadido al carrito.`);
        }

        // Eliminar producto del carrito
        function removeFromCart(productId) {
            const product = cart.find(item => item.id === productId);
            if (!product) return;
            cart = cart.filter(item => item.id !== productId);
            updateCart();
            showToast(`"${product.name}" eliminado del carrito.`);
        }

        // Actualizar cantidad de producto en el carrito
        function updateQuantity(productId, change) {
            const item = cart.find(i => i.id === productId);
            if (!item) return;

            const newQuantity = item.quantity + change;

            if (newQuantity <= 0) {
                removeFromCart(productId);
            } else {
                item.quantity = newQuantity;
                updateCart();
            }
        }

        // Función principal para recalcular totales y actualizar UI
        function updateCart() {
            const totalCount = cart.reduce((sum, item) => sum + item.quantity, 0);
            const totalPrice = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            
            cartCount.textContent = totalCount;
            cartTotal.textContent = `$${totalPrice.toFixed(2)}`;

            if (totalCount > 0) {
                checkoutBtn.disabled = false;
                checkoutBtn.innerHTML = '<i class="fab fa-whatsapp"></i> Finalizar Compra por WhatsApp';
            } else {
                checkoutBtn.disabled = true;
                checkoutBtn.innerHTML = '<i class="fab fa-whatsapp"></i> Finalizar Compra por WhatsApp';
            }

            renderCartItems();
            saveCartToStorage();
        }

        // Renderizar items del carrito
        function renderCartItems() {
            cartItems.innerHTML = '';
            
            if (cart.length === 0) {
                cartItems.appendChild(emptyCart);
                emptyCart.style.display = 'block';
                return;
            }
            
            emptyCart.style.display = 'none';

            cart.forEach(item => {
                const cartItem = document.createElement('div');
                cartItem.className = 'cart-item';
                cartItem.innerHTML = `
                    <img src="${item.image}" alt="${item.name}" class="cart-item-image" onerror="this.onerror=null;this.src='https://via.placeholder.com/80x80?text=IMG'">
                    <div class="cart-item-details">
                        <div class="cart-item-title">${item.name}</div>
                        <div class="cart-item-price">$${item.price.toFixed(2)}</div>
                        <div class="cart-item-quantity">
                            <button class="quantity-btn minus" data-id="${item.id}">-</button>
                            <input type="number" class="quantity-input" value="${item.quantity}" min="1" data-id="${item.id}" readonly>
                            <button class="quantity-btn plus" data-id="${item.id}">+</button>
                        </div>
                        <button class="remove-item" data-id="${item.id}">
                            <i class="fas fa-trash"></i> Eliminar
                        </button>
                    </div>
                `;
                cartItems.appendChild(cartItem);
            });

            // Añadir event listeners a los controles de cantidad
            document.querySelectorAll('.quantity-btn.minus').forEach(button => {
                button.addEventListener('click', (e) => {
                    const productId = parseInt(e.target.getAttribute('data-id'));
                    updateQuantity(productId, -1);
                });
            });
            document.querySelectorAll('.quantity-btn.plus').forEach(button => {
                button.addEventListener('click', (e) => {
                    const productId = parseInt(e.target.getAttribute('data-id'));
                    updateQuantity(productId, 1);
                });
            });
            document.querySelectorAll('.remove-item').forEach(button => {
                button.addEventListener('click', (e) => {
                    const productId = parseInt(e.target.getAttribute('data-id'));
                    removeFromCart(productId);
                });
            });
        }
        
        // --- 8. LÓGICA DE MODALES ---

        // Abrir modal de carrito
        function openCart() {
            cartModal.classList.add('open');
            overlay.classList.add('active');
            document.body.style.overflow = 'hidden'; // Evita el scroll del fondo
            updateCart();
        }

        // Cerrar modal de carrito
        function closeCartModal() {
            cartModal.classList.remove('open');
            // Si el overlay no es usado por otro modal, cerrarlo.
            if (!productDetailModal.classList.contains('active') && 
                !checkoutModal.classList.contains('active') &&
                !generalModal.classList.contains('active')) {
                overlay.classList.remove('active');
                document.body.style.overflow = 'auto';
            }
        }

        // Abrir modal de checkout
        function openCheckoutModal() {
            closeCartModal(); // Cerrar carrito primero
            checkoutModal.classList.add('active');
            overlay.classList.add('active');
            document.body.style.overflow = 'hidden';
        }

        // Cerrar modal de checkout
        function closeCheckoutModal() {
            checkoutModal.classList.remove('active');
            // Si el overlay no es usado por otro modal, cerrarlo.
            if (!productDetailModal.classList.contains('active') && 
                !cartModal.classList.contains('open') &&
                !generalModal.classList.contains('active')) {
                overlay.classList.remove('active');
                document.body.style.overflow = 'auto';
            }
            openCart(); // Volver al carrito
        }
        
        // Mostrar detalles del producto
        function showProductDetails(productId) {
            const product = products.find(p => p.id === productId);
            if (product) {
                // Actualizar contenido del modal de detalles
                productDetailBody.innerHTML = `
                    <div class="product-detail-image">
                        <img src="${product.image}" alt="${product.name}" onerror="this.onerror=null;this.src='https://via.placeholder.com/400x400?text=IMG'">
                    </div>
                    <div class="product-detail-info">
                        <h2 class="product-detail-title">${product.name}</h2>
                        <div class="product-detail-price">$${product.price.toFixed(2)}</div>
                        <p class="product-detail-description">${product.description}</p>
                        <div class="product-detail-features">
                            <h3>Características:</h3>
                            <ul>
                                ${product.features.map(feature => `<li>${feature}</li>`).join('')}
                            </ul>
                        </div>
                        <div class="quantity-selector">
                            <label for="detail-quantity">Cantidad:</label>
                            <input type="number" id="detail-quantity" class="quantity-input" value="1" min="1" style="width: 5rem;">
                        </div>
                        <div class="product-detail-actions">
                            <button class="btn btn-primary btn-full add-to-cart-detail" data-id="${product.id}">
                                <i class="fas fa-cart-plus"></i> Añadir al Carrito
                            </button>
                        </div>
                    </div>
                `;

                // Añadir listener al botón de añadir al carrito dentro del modal
                document.querySelector('.add-to-cart-detail').addEventListener('click', (e) => {
                    const id = parseInt(e.target.getAttribute('data-id'));
                    const quantity = parseInt(document.getElementById('detail-quantity').value);
                    addToCart(id, quantity);
                    closeProductDetail();
                });
                
                // Abrir modal de detalles
                productDetailModal.classList.add('active');
                overlay.classList.add('active');
                document.body.style.overflow = 'hidden';
            }
        }

        // Cerrar modal de detalles del producto
        function closeProductDetail() {
            productDetailModal.classList.remove('active');
            // Si el overlay no es usado por otro modal, cerrarlo.
            if (!cartModal.classList.contains('open') && 
                !checkoutModal.classList.contains('active') &&
                !generalModal.classList.contains('active')) {
                overlay.classList.remove('active');
                document.body.style.overflow = 'auto';
            }
        }
        
        // Abrir Modal General (Políticas, Términos)
        function openGeneralModal(title, content) {
            generalModalTitle.textContent = title;
            generalModalBody.innerHTML = content;
            generalModal.classList.add('active');
            overlay.classList.add('active');
            document.body.style.overflow = 'hidden';
        }

        // Cerrar Modal General
        function closeGeneralModalHandler() {
            generalModal.classList.remove('active');
            // Si el overlay no es usado por otro modal, cerrarlo.
            if (!cartModal.classList.contains('open') && 
                !checkoutModal.classList.contains('active') &&
                !productDetailModal.classList.contains('active')) {
                overlay.classList.remove('active');
                document.body.style.overflow = 'auto';
            }
        }

        // Cerrar todos los modales al hacer clic en el overlay
        function closeAllModals() {
            if (cartModal.classList.contains('open')) {
                closeCartModal();
            }
            if (productDetailModal.classList.contains('active')) {
                closeProductDetail();
            }
            if (checkoutModal.classList.contains('active')) {
                // En el checkout modal, queremos volver al carrito
                closeCheckoutModal(); 
            }
            if (generalModal.classList.contains('active')) {
                closeGeneralModalHandler();
            }
        }

        // --- 9. LÓGICA DE CHECKOUT (WhatsApp) ---

        // Procesar formulario de checkout y enviar a WhatsApp
        function processCheckout(e) {
            e.preventDefault();

            const name = document.getElementById('name').value;
            const phone = document.getElementById('phone').value;
            const address = document.getElementById('address').value;
            const city = document.getElementById('city').value;
            const notes = document.getElementById('notes').value;
            const total = cartTotal.textContent;

            let productList = "📦 *DETALLES DEL PEDIDO*\n";
            cart.forEach(item => {
                productList += `- ${item.name} (${item.quantity} und.) = $${(item.price * item.quantity).toFixed(2)}\n`;
            });
            productList += `\n*TOTAL A PAGAR: ${total}*`;

            const message = `¡Hola! He realizado un pedido en ECHO Technology Store. Aquí están los detalles:\n\n` +
                            `👤 *DATOS DEL CLIENTE*\n` +
                            `Nombre: ${name}\n` +
                            `Teléfono: ${phone}\n\n` +
                            `📍 *DIRECCIÓN DE ENVÍO*\n` +
                            `Dirección: ${address}\n` +
                            `Ciudad/Cantón: ${city}\n\n` +
                            `${productList}\n\n` +
                            `📝 *NOTAS ADICIONALES:*\n${notes || 'Ninguna.'}\n\n` +
                            `Por favor, ayúdame a concretar este pedido. Confirmo los datos de envío y espero instrucciones para el pago.`;

            // Codificar el mensaje para la URL de WhatsApp
            const whatsappNumber = '593967879068'; // NÚMERO ACTUALIZADO
            const whatsappURL = `https://wa.me/${whatsappNumber}?text=${encodeURIComponent(message)}`;

            // Abrir WhatsApp en una nueva pestaña/ventana
            window.open(whatsappURL, '_blank');

            // Cerrar modales y vaciar carrito
            closeCheckoutModal();
            closeCartModal();
            
            // Mostrar mensaje de confirmación
            showToast('¡Pedido enviado con éxito! Serás redirigido a WhatsApp para concretar.');
            
            // Vaciar carrito
            cart = [];
            updateCart();
            saveCartToStorage(); // Limpiar localStorage
            
            // Limpiar formulario
            checkoutForm.reset();
        }
        
        // --- 10. LÓGICA DE UTILIDADES ---
        
        // Contenido Modal de Política de Privacidad
        function getPrivacyPolicyContent() {
            return `
                <h3>Recolección de Información</h3>
                <p>Recolectamos información como nombre, número de teléfono (WhatsApp) y dirección para procesar su pedido y facilitar la entrega.</p>
                <h3>Uso de la Información</h3>
                <ul>
                    <li>Procesar y gestionar su pedido.</li>
                    <li>Comunicarnos con usted vía WhatsApp sobre el estado de su compra.</li>
                    <li>Mejorar nuestros servicios y ofertas.</li>
                </ul>
                <h3>Compartir Información</h3>
                <p>No vendemos, intercambiamos ni transferimos su información personal a terceros, excepto en la medida necesaria para el proceso logístico de entrega (ej. courier).</p>
            `;
        }

        // Contenido Modal de Términos de Servicio
        function getTermsOfServiceContent() {
            return `
                <h3>Aceptación de Términos</h3>
                <p>Al utilizar nuestra tienda en línea y realizar un pedido, usted acepta los siguientes términos y condiciones.</p>
                <h3>Precios y Pagos</h3>
                <p>Los precios de los productos están indicados en dólares estadounidenses ($). El pago se coordina directamente a través de WhatsApp con nuestro equipo, una vez que haya enviado su pedido con la información de envío.</p>
                <h3>Envíos y Entregas</h3>
                <p>Los pedidos se procesan tras la confirmación del pago. Los tiempos de envío varían según su ubicación. No nos hacemos responsables por demoras causadas por la empresa de transporte una vez que el paquete ha sido entregado a la misma.</p>
                <h3>Garantía y Devoluciones</h3>
                <p>La garantía aplica por defectos de fábrica. Las devoluciones o cambios se analizan caso por caso, y deben ser notificadas a nuestro número de contacto en un plazo máximo de 48 horas tras la recepción del producto.</p>
            `;
        }

        // Cambiar tema
        function toggleTheme() {
            document.body.classList.toggle('dark-mode');
            
            if (document.body.classList.contains('dark-mode')) {
                themeToggle.innerHTML = '<i class="fas fa-sun"></i>';
                localStorage.setItem('theme', 'dark');
            } else {
                themeToggle.innerHTML = '<i class="fas fa-moon"></i>';
                localStorage.setItem('theme', 'light');
            }
        }
        
        // Mostrar notificación toast
        function showToast(message) {
            toastMessage.textContent = message;
            toast.classList.add('show');
            setTimeout(() => {
                toast.classList.remove('show');
            }, 3000);
        }

        // Inicializar la tienda cuando se carga la página
        document.addEventListener('DOMContentLoaded', initStore);
    </script>
</body>
</html>